(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42040,e=>{"use strict";let t=(0,e.i(88715).createClient)("https://xppnvkuahlrdyfvabzur.supabase.co","sb_publishable_ui0m9IIp-8VQUfHLCb4d1w_LcwHa0Zd");e.s(["supabase",0,t])},73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},66531,e=>{"use strict";let t=(0,e.i(75254).default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);e.s(["UploadCloud",()=>t],66531)},94008,e=>{"use strict";let t=(0,e.i(75254).default)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]);e.s(["File",()=>t],94008)},87996,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(73375),i=e.i(66531),n=e.i(94008),r=e.i(37727),o=e.i(71675),d=e.i(42040);let c=["knee","back","neck","shoulder","hip","wrist","ankle","head","chest","abdomen","other"],u=["<1w","1-4w","1-6m","6m-1y","1y+"];function x({setView:e}){let x=(0,a.useSearchParams)(),m=(0,a.useRouter)(),h=(0,o.useToast)(),p=x.get("inquiryId"),b=x.get("token"),[y,g]=(0,s.useState)({body_part:[],duration:"",severity:"",diagnosis_yesno:!1,diagnosis_text:"",medication_yesno:!1,medication_text:""}),[f,j]=(0,s.useState)([]),[v,N]=(0,s.useState)(!1),[k,_]=(0,s.useState)(!1);(0,s.useEffect)(()=>{p&&b||(h.error("Missing inquiryId or token."),m.push("/inquiry"))},[p,b,m,h]);let w=async()=>{if(p&&b){N(!0);try{let e=[];if(f.length)for(let t of f){let s=`inquiry/${Date.now()}_${t.name}`,{error:a}=await d.supabase.storage.from("attachments").upload(s,t);a||e.push({path:s,name:t.name,type:t.type||null})}let t={complaint:{body_part:y.body_part.length?y.body_part:null,duration:y.duration||null,severity:y.severity?Number(y.severity):null},history:{diagnosis:{has:!!y.diagnosis_yesno,text:y.diagnosis_text||""},meds:{has:!!y.medication_yesno,text:y.medication_text||""}}};e.length&&(t.attachments_extra=e);let s=await fetch("/api/inquiries/intake",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inquiryId:Number(p),publicToken:b,intakePatch:t})}),a=await s.json().catch(()=>({}));if(!s.ok){h.error(a?.error||"Failed to save."),N(!1);return}try{sessionStorage.removeItem("inquiry_success")}catch(e){}null!=p&&fetch("/api/inquiries/event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventType:"step2_submitted",inquiryId:Number(p)})}).catch(()=>{}),_(!0)}catch(e){console.error(e),h.error("Failed to save.")}finally{N(!1)}}};return p&&b?k?(0,t.jsxs)("div",{className:"max-w-lg mx-auto px-4 py-12 text-center",children:[(0,t.jsx)("p",{className:"text-lg font-bold text-teal-700 mb-4",children:"Additional info saved."}),(0,t.jsx)("button",{onClick:()=>e?.("home")||m.push("/"),className:"text-teal-600 font-bold hover:underline",children:"Return to Home"})]}):(0,t.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,t.jsxs)("button",{onClick:()=>m.back(),className:"flex items-center text-sm font-bold text-gray-500 mb-6 hover:text-teal-600",children:[(0,t.jsx)(l.ChevronLeft,{size:16})," Back"]}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Additional info (optional)"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Helps us match you with better hospital estimates."}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Body part(s)"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{g(t=>({...t,body_part:t.body_part.includes(e)?t.body_part.filter(t=>t!==e):[...t.body_part,e]}))},className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${y.body_part.includes(e)?"bg-teal-100 border-teal-500 text-teal-800":"bg-gray-50 border-gray-200 text-gray-600"}`,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Duration"}),(0,t.jsxs)("select",{value:y.duration,onChange:e=>g({...y,duration:e.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",children:[(0,t.jsx)("option",{value:"",children:"Select..."}),u.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Severity (1â€“10)"}),(0,t.jsx)("input",{type:"number",min:1,max:10,value:y.severity,onChange:e=>g({...y,severity:e.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. 7"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Prior diagnosis?"}),(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:!!y.diagnosis_yesno,onChange:e=>g({...y,diagnosis_yesno:e.target.checked}),className:"rounded accent-teal-600"}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),y.diagnosis_yesno&&(0,t.jsx)("textarea",{value:y.diagnosis_text,onChange:e=>g({...y,diagnosis_text:e.target.value}),rows:2,className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. MRI: meniscus tear"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Current medications?"}),(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:!!y.medication_yesno,onChange:e=>g({...y,medication_yesno:e.target.checked}),className:"rounded accent-teal-600"}),(0,t.jsx)("span",{className:"text-sm",children:"Yes"})]}),y.medication_yesno&&(0,t.jsx)("textarea",{value:y.medication_text,onChange:e=>g({...y,medication_text:e.target.value}),rows:2,className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. ibuprofen"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"file",id:"step2file",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&j(e=>[...e,t])}}),(0,t.jsxs)("div",{onClick:()=>document.getElementById("step2file")?.click(),className:"border border-dashed border-gray-300 rounded-xl p-3 text-center hover:bg-gray-50 cursor-pointer flex items-center justify-center gap-2",children:[(0,t.jsx)(i.UploadCloud,{size:18,className:"text-gray-400"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Upload more (optional)"})]}),f.length>0&&(0,t.jsx)("div",{className:"mt-2 space-y-1",children:f.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(n.File,{size:14}),(0,t.jsx)("span",{className:"truncate",children:e.name}),(0,t.jsx)("button",{type:"button",onClick:()=>j(e=>e.filter((e,t)=>t!==s)),className:"text-red-500",children:(0,t.jsx)(r.X,{size:14})})]},s))})]}),(0,t.jsx)("button",{onClick:w,disabled:v,className:"w-full bg-teal-600 text-white py-4 rounded-xl font-bold hover:bg-teal-700 disabled:opacity-50",children:v?"Saving...":"Save"})]})]}):null}function m(){let e=(0,a.useRouter)();return(0,t.jsx)(x,{setView:t=>{e.push("/")}})}e.s(["default",()=>m],87996)}]);