module.exports=[82484,a=>{"use strict";let b=(0,a.i(83160).createClient)("https://xppnvkuahlrdyfvabzur.supabase.co","sb_publishable_ui0m9IIp-8VQUfHLCb4d1w_LcwHa0Zd");a.s(["supabase",0,b])},13749,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["ChevronLeft",()=>b],13749)},74618,a=>{"use strict";let b=(0,a.i(70106).default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);a.s(["UploadCloud",()=>b],74618)},35487,a=>{"use strict";let b=(0,a.i(70106).default)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]);a.s(["File",()=>b],35487)},38740,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(13749),f=a.i(74618),g=a.i(35487),h=a.i(33508),i=a.i(51088),j=a.i(82484);let k=["knee","back","neck","shoulder","hip","wrist","ankle","head","chest","abdomen","other"],l=["<1w","1-4w","1-6m","6m-1y","1y+"];function m({setView:a}){let m=(0,d.useSearchParams)(),n=(0,d.useRouter)(),o=(0,i.useToast)(),p=m.get("inquiryId"),q=m.get("token"),[r,s]=(0,c.useState)({body_part:[],duration:"",severity:"",diagnosis_yesno:!1,diagnosis_text:"",medication_yesno:!1,medication_text:""}),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{p&&q||(o.error("Missing inquiryId or token."),n.push("/inquiry"))},[p,q,n,o]);let z=async()=>{if(p&&q){w(!0);try{let a=[];if(t.length)for(let b of t){let c=`inquiry/${Date.now()}_${b.name}`,{error:d}=await j.supabase.storage.from("attachments").upload(c,b);d||a.push({path:c,name:b.name,type:b.type||null})}let b={complaint:{body_part:r.body_part.length?r.body_part:null,duration:r.duration||null,severity:r.severity?Number(r.severity):null},history:{diagnosis:{has:!!r.diagnosis_yesno,text:r.diagnosis_text||""},meds:{has:!!r.medication_yesno,text:r.medication_text||""}}};a.length&&(b.attachments_extra=a);let c=await fetch("/api/inquiries/intake",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inquiryId:Number(p),publicToken:q,intakePatch:b})}),d=await c.json().catch(()=>({}));if(!c.ok){o.error(d?.error||"Failed to save."),w(!1);return}try{sessionStorage.removeItem("inquiry_success")}catch(a){}null!=p&&fetch("/api/inquiries/event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventType:"step2_submitted",inquiryId:Number(p)})}).catch(()=>{}),y(!0)}catch(a){console.error(a),o.error("Failed to save.")}finally{w(!1)}}};return p&&q?x?(0,b.jsxs)("div",{className:"max-w-lg mx-auto px-4 py-12 text-center",children:[(0,b.jsx)("p",{className:"text-lg font-bold text-teal-700 mb-4",children:"Additional info saved."}),(0,b.jsx)("button",{onClick:()=>a?.("home")||n.push("/"),className:"text-teal-600 font-bold hover:underline",children:"Return to Home"})]}):(0,b.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,b.jsxs)("button",{onClick:()=>n.back(),className:"flex items-center text-sm font-bold text-gray-500 mb-6 hover:text-teal-600",children:[(0,b.jsx)(e.ChevronLeft,{size:16})," Back"]}),(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Additional info (optional)"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Helps us match you with better hospital estimates."}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Body part(s)"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:k.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{s(b=>({...b,body_part:b.body_part.includes(a)?b.body_part.filter(b=>b!==a):[...b.body_part,a]}))},className:`px-3 py-1.5 rounded-lg text-sm font-medium border ${r.body_part.includes(a)?"bg-teal-100 border-teal-500 text-teal-800":"bg-gray-50 border-gray-200 text-gray-600"}`,children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Duration"}),(0,b.jsxs)("select",{value:r.duration,onChange:a=>s({...r,duration:a.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",children:[(0,b.jsx)("option",{value:"",children:"Select..."}),l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Severity (1â€“10)"}),(0,b.jsx)("input",{type:"number",min:1,max:10,value:r.severity,onChange:a=>s({...r,severity:a.target.value}),className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. 7"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Prior diagnosis?"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!r.diagnosis_yesno,onChange:a=>s({...r,diagnosis_yesno:a.target.checked}),className:"rounded accent-teal-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),r.diagnosis_yesno&&(0,b.jsx)("textarea",{value:r.diagnosis_text,onChange:a=>s({...r,diagnosis_text:a.target.value}),rows:2,className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. MRI: meniscus tear"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-bold text-gray-700 mb-2",children:"Current medications?"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mb-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!r.medication_yesno,onChange:a=>s({...r,medication_yesno:a.target.checked}),className:"rounded accent-teal-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),r.medication_yesno&&(0,b.jsx)("textarea",{value:r.medication_text,onChange:a=>s({...r,medication_text:a.target.value}),rows:2,className:"w-full p-3 rounded-xl border border-gray-200 focus:border-teal-500 outline-none text-sm",placeholder:"e.g. ibuprofen"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("input",{type:"file",id:"step2file",className:"hidden",onChange:a=>{let b=a.target.files?.[0];b&&u(a=>[...a,b])}}),(0,b.jsxs)("div",{onClick:()=>document.getElementById("step2file")?.click(),className:"border border-dashed border-gray-300 rounded-xl p-3 text-center hover:bg-gray-50 cursor-pointer flex items-center justify-center gap-2",children:[(0,b.jsx)(f.UploadCloud,{size:18,className:"text-gray-400"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Upload more (optional)"})]}),t.length>0&&(0,b.jsx)("div",{className:"mt-2 space-y-1",children:t.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(g.File,{size:14}),(0,b.jsx)("span",{className:"truncate",children:a.name}),(0,b.jsx)("button",{type:"button",onClick:()=>u(a=>a.filter((a,b)=>b!==c)),className:"text-red-500",children:(0,b.jsx)(h.X,{size:14})})]},c))})]}),(0,b.jsx)("button",{onClick:z,disabled:v,className:"w-full bg-teal-600 text-white py-4 rounded-xl font-bold hover:bg-teal-700 disabled:opacity-50",children:v?"Saving...":"Save"})]})]}):null}function n(){let a=(0,d.useRouter)();return(0,b.jsx)(m,{setView:b=>{a.push("/")}})}a.s(["default",()=>n],38740)}];

//# sourceMappingURL=_3948c5f2._.js.map