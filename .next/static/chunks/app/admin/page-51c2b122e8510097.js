(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{567:(e,t,s)=>{"use strict";s.d(t,{Yq:()=>o,Yr:()=>i,ZT:()=>l});var a=s(5612);let r=e=>{switch(e){case"ko":return"ko-KR";case"zh":return"zh-CN";case"ja":return"ja-JP";default:return"en-US"}},l=(e,t="en")=>{let s=((e,t="en")=>{let s=Number(e);return Number.isNaN(s)?"":s.toLocaleString(r(t))})(e,t);return s?`$${s}`:""},i=(e,t,s="en")=>{let r=null!=e,i=null!=t;return r&&i?`${l(e,s)} - ${l(t,s)}`:r?`${l(e,s)}${(0,a.t)("price.plus",s)}`:i?`${(0,a.t)("price.upTo",s)} ${l(t,s)}`:(0,a.t)("price.askQuote",s)},o=(e,t="en")=>e?(e instanceof Date?e:new Date(e)).toLocaleDateString(r(t)):""},2517:(e,t,s)=>{"use strict";s.d(t,{d:()=>p,t:()=>x});var a=s(5155),r=s(2115),l=s(2651),i=s(2791),o=s(8822),n=s(3545),d=s(3210);let c=(0,r.createContext)(null),x=({children:e})=>{let[t,s]=(0,r.useState)([]),l=(0,r.useCallback)((e,t="info",a=3e3)=>{let r=Date.now()+Math.random(),l={id:r,message:e,type:t};s(e=>[...e,l]),setTimeout(()=>{s(e=>e.filter(e=>e.id!==r))},a)},[]),i=(0,r.useCallback)(e=>{s(t=>t.filter(t=>t.id!==e))},[]);return(0,a.jsxs)(c.Provider,{value:{toast:{success:e=>l(e,"success"),error:e=>l(e,"error"),info:e=>l(e,"info"),warning:e=>l(e,"warning")},removeToast:i},children:[e,(0,a.jsx)("div",{className:"fixed top-20 right-4 z-[200] space-y-2 pointer-events-none",children:t.map(e=>(0,a.jsx)(m,{toast:e,onRemove:i},e.id))})]})},m=({toast:e,onRemove:t})=>{let{message:s,type:r}=e,c={success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",icon:(0,a.jsx)(l.A,{size:20,className:"text-green-600"})},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:(0,a.jsx)(i.A,{size:20,className:"text-red-600"})},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",icon:(0,a.jsx)(o.A,{size:20,className:"text-blue-600"})},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",icon:(0,a.jsx)(n.A,{size:20,className:"text-yellow-600"})}},x=c[r]||c.info;return(0,a.jsxs)("div",{className:`
        ${x.bg} ${x.border} ${x.text}
        border rounded-xl shadow-lg p-4 min-w-[300px] max-w-[400px]
        flex items-start gap-3 animate-in slide-in-from-right fade-in
        pointer-events-auto
      `,children:[(0,a.jsx)("div",{className:"shrink-0 mt-0.5",children:x.icon}),(0,a.jsx)("div",{className:"flex-1 text-sm font-medium",children:s}),(0,a.jsx)("button",{onClick:()=>t(e.id),className:"shrink-0 p-1 hover:bg-black/5 rounded transition",children:(0,a.jsx)(d.A,{size:16,className:x.text})})]})},p=()=>{let e=(0,r.useContext)(c);if(!e)throw Error("useToast must be used within ToastProvider");return e.toast}},5365:(e,t,s)=>{"use strict";s.d(t,{N:()=>i});var a=s(4197);let r="https://xppnvkuahlrdyfvabzur.supabase.co",l="sb_publishable_ui0m9IIp-8VQUfHLCb4d1w_LcwHa0Zd";if(!r||!l){let e=[];throw r||e.push("NEXT_PUBLIC_SUPABASE_URL"),l||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY"),Error(`❌ Supabase 환경 변수가 설정되지 않았습니다!
누락된 변수: ${e.join(", ")}
프로젝트 루트에 .env.local 파일을 생성하고 다음을 추가하세요:
NEXT_PUBLIC_SUPABASE_URL=your_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_key`)}let i=(0,a.UU)(r,l)},5612:(e,t,s)=>{"use strict";s.d(t,{q:()=>r,t:()=>i,y:()=>l});let a={en:{"cta.freePlan":"Get Free Treatment Plan","nav.treatments":"Treatments","nav.hospitals":"Hospitals","nav.about":"About HEALO","nav.contact":"Contact","nav.privacy":"Privacy Policy","nav.terms":"Terms of Service","auth.login":"Log In","auth.signup":"Sign Up","auth.logout":"Log Out","auth.greeting":"Hi","footer.company":"Company","footer.legal":"Legal","hero.title.line1":"Find the Best Hospital in Korea","hero.title.highlight":"in 30 Seconds.","hero.subtitle.line1":"AI compares treatments, doctors, and prices so you don't have to.","hero.subtitle.line2":"Your personal medical concierge service.","search.placeholder":"Try searching for 'Stem Cell'...","search.button":"Search","card.estPrice":"Est. Price","price.inquire":"Inquire","price.askQuote":"Ask for quote","price.upTo":"Up to","price.plus":"+","list.treatments.title":"All Treatments","list.hospitals.title":"Partner Hospitals","meta.treatments.title":"Treatments","meta.treatments.desc":"Browse all HEALO treatments and compare partner hospitals in Korea.","meta.hospitals.title":"Hospitals","meta.hospitals.desc":"Browse partner hospitals and clinics across Korea."},ko:{},zh:{},ja:{}},r=()=>{if("u"<typeof document)return"en";let e=document.cookie.split(";").find(e=>e.trim().startsWith("googtrans="));if(!e)return"en";let t=e.split("=")[1].split("/").pop();return"ko"===t?"ko":"zh-CN"===t?"zh":"ja"===t?"ja":"en"},l=e=>{switch(e){case"KOR":return"ko";case"CHN":return"zh";case"JPN":return"ja";default:return"en"}},i=(e,t="en")=>(a[t]||a.en)[e]||a.en[e]||e},7996:(e,t,s)=>{Promise.resolve().then(s.bind(s,9310))},9310:(e,t,s)=>{"use strict";s.d(t,{default:()=>V});var a=s(5155),r=s(2115),l=s(3321),i=s(5365),o=s(3210),n=s(6296),d=s(7531),c=s(8401),x=s(9123),m=s(6035),p=s(49),u=s(1283),g=s(9363),h=s(2508),b=s(1313),f=s(2517),y=s(676),j=s(4538);let N=({value:e,onChange:t,onLocationSelect:s,placeholder:l="한국어 주소를 검색하세요 (예: 강남구 테헤란로 123)"})=>{let[i,n]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:l,className:"w-full pl-10 pr-20 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none transition text-sm"}),(0,a.jsxs)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[e&&(0,a.jsx)("button",{type:"button",onClick:()=>t(""),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{size:16})}),(0,a.jsx)("button",{type:"button",onClick:()=>n(!0),className:"text-xs font-bold text-teal-600 px-2 py-1 rounded border border-teal-200 hover:bg-teal-50 transition",children:"검색"})]})]}),i&&(0,a.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/40 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-gray-700",children:"주소 검색"}),(0,a.jsx)("button",{type:"button",onClick:()=>n(!1),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.A,{size:18})})]}),(0,a.jsx)("div",{className:"p-3",children:(0,a.jsx)(y.Ay,{onComplete:e=>{let a=e.address||"",r=e.addressEnglish||"",l=e.zonecode||"";t?.(a),s?.({koAddress:a,enAddress:r,zonecode:l}),n(!1)},style:{width:"100%",height:"420px"}})})]})})]})};var v=s(4071),w=s(6498),_=s(8822),k=s(3545),A=s(5269),C=s(3219),S=s(567);let P=({analytics:e})=>(0,a.jsxs)("div",{className:"animate-in fade-in space-y-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-end border-b border-gray-200 pb-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-black text-gray-900 tracking-tight",children:"Market Intelligence (시장 분석)"}),(0,a.jsxs)("p",{className:"text-gray-500 mt-2 text-sm max-w-xl leading-relaxed",children:["실시간 ",(0,a.jsx)("span",{className:"font-bold text-gray-800",children:"환자 수요 트렌드"})," 및 ",(0,a.jsx)("span",{className:"font-bold text-gray-800",children:"시장 기회(Opportunity)"})," 분석 보고서입니다.",(0,a.jsx)("br",{}),"미체결 수요를 확인하고 제휴 영업 우선순위를 선정하세요."]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsx)("div",{className:"p-3 bg-teal-50 rounded-xl text-teal-700",children:(0,a.jsx)(v.A,{size:24})}),(0,a.jsx)("span",{className:"text-[10px] font-bold bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"+12% 성장"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:"총 활성 문의 (Active Leads)"}),(0,a.jsxs)("p",{className:"text-3xl font-black text-gray-900 mt-1",children:[e.totalLeads," 건"]}),(0,a.jsx)("p",{className:"text-[11px] text-gray-400 mt-2",children:"현재 유효한 환자 상담 수요"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm relative overflow-hidden",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-blue-50 rounded-xl text-blue-700",children:(0,a.jsx)(w.A,{size:24})})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:"시장 기회 총액 (Est. Opportunity)"}),(0,a.jsx)("p",{className:"text-3xl font-black text-gray-900 mt-1",children:(0,S.ZT)(e.totalRevenue,"en")}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-2 text-[11px] text-gray-400",children:[(0,a.jsx)(_.A,{size:12})," 문의당 평균 시술가 $3,500 기준"]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm relative overflow-hidden",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl text-purple-700",children:(0,a.jsx)(h.A,{size:24})})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:"최다 수요 카테고리"}),(0,a.jsx)("p",{className:"text-2xl font-black text-gray-900 mt-1 truncate",children:e.topTreatment}),(0,a.jsx)("p",{className:"text-[11px] text-purple-600 font-bold mt-2 flex items-center gap-1",children:"Action: 해당 분야 전문 병원 확보 시급"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,a.jsx)(k.A,{size:20,className:"text-red-500"}),"기회 비용 및 수요 분석 (Opportunity Analysis)"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-6",children:"현재 발생 중인 수요가 어디로 흐르고 있는지 분석합니다. '미체결 수요'는 즉시 매출화 가능한 기회입니다."}),(0,a.jsx)("div",{className:"overflow-hidden border border-gray-100 rounded-xl",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 text-gray-500 text-xs uppercase font-bold",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"타겟 병원 / 그룹"}),(0,a.jsx)("th",{className:"py-3 px-4 text-center",children:"문의 수"}),(0,a.jsx)("th",{className:"py-3 px-4 text-right",children:"잠재 매출 기회"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"대응 전략"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[e.hospitalOpportunities.map(e=>(0,a.jsxs)("tr",{className:`hover:bg-gray-50 transition ${"기회 비용 (Missed)"===e.status?"bg-red-50/30":""}`,children:[(0,a.jsxs)("td",{className:"py-4 px-4",children:[(0,a.jsx)("div",{className:"font-bold text-gray-800",children:e.name}),(0,a.jsx)("div",{className:"text-[10px] text-gray-400 font-medium uppercase mt-0.5",children:e.status})]}),(0,a.jsx)("td",{className:"py-4 px-4 text-center",children:(0,a.jsx)("span",{className:`font-bold px-2 py-1 rounded-md ${"기회 비용 (Missed)"===e.status?"text-red-600 bg-red-100":"text-gray-700 bg-gray-100"}`,children:e.count})}),(0,a.jsx)("td",{className:"py-4 px-4 text-right font-black text-gray-700",children:(0,S.ZT)(e.marketValue,"en")}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsxs)("span",{className:`text-[10px] font-bold px-2 py-1 rounded border flex items-center w-fit gap-1
                        ${"매칭 완료"===e.status?"bg-teal-50 text-teal-700 border-teal-100":"기회 비용 (Missed)"===e.status?"bg-blue-50 text-blue-700 border-blue-100 cursor-pointer hover:bg-blue-100":"bg-orange-50 text-orange-700 border-orange-100 cursor-pointer hover:bg-orange-100"}`,children:[e.action,"매칭 완료"!==e.status&&(0,a.jsx)(A.A,{size:10})]})})]},e.id)),0===e.hospitalOpportunities.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"4",className:"py-8 text-center text-gray-400",children:"데이터 수집 중..."})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-sm flex flex-col",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,a.jsx)(C.A,{size:20,className:"text-teal-600"}),"시장 수요 트렌드 (Market Trends)"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-6",children:"해외 환자들이 현재 가장 많이 찾고 있는 시술 카테고리입니다."}),(0,a.jsxs)("div",{className:"flex-1 space-y-6",children:[e.treatmentTrends.slice(0,5).map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-bold mb-1.5",children:[(0,a.jsx)("span",{className:"text-gray-800",children:e.name}),(0,a.jsxs)("span",{className:"text-teal-600",children:[e.percent,"% 점유율"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-teal-500 h-2.5 rounded-full shadow-sm",style:{width:`${e.percent}%`}})}),(0,a.jsxs)("p",{className:"text-[10px] text-gray-400 mt-1 text-right",children:[e.count,"건의 활성 문의"]})]},t)),0===e.treatmentTrends.length&&(0,a.jsx)("div",{className:"text-center text-gray-400 py-10",children:"데이터 대기 중..."})]}),(0,a.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[(0,a.jsxs)("p",{className:"text-xs font-bold text-blue-800 mb-1 flex items-center gap-2",children:[(0,a.jsx)(_.A,{size:14})," Strategic Insight"]}),(0,a.jsxs)("p",{className:"text-[11px] text-blue-700 leading-snug",children:["현재 ",(0,a.jsxs)("span",{className:"font-bold",children:['"',e.topTreatment,'"']})," 카테고리의 수요가 시장을 주도하고 있습니다. 리드 이탈(Leakage)을 막기 위해 해당 분야 전문 파트너 병원을 최소 3곳 이상 확보하는 것을 권장합니다."]})]})})]})]})]});var z=s(6558),T=s(1958);let q=({inquiries:e,fetchInquiries:t,handleStatusChange:s,handleFileClick:r})=>{let l=({item:e})=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-gray-500 text-sm",children:(0,S.Yq)(e.created_at,"en")}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsxs)("div",{className:"font-bold",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("div",{className:"text-xs text-teal-600",children:e.email})]}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-600",children:[(0,a.jsx)("div",{children:e.treatment_type}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.contact_method})]}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"p-2 bg-gray-50 rounded text-xs text-gray-700 max-h-20 overflow-y-auto",children:e.message})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:e.attachment?(0,a.jsx)("button",{onClick:()=>r(e.attachment),children:(0,a.jsx)(z.A,{size:16})}):"-"}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("select",{value:e.status||"대기중",onChange:t=>s(e.id,t.target.value),className:"border rounded p-1 text-xs",children:[(0,a.jsx)("option",{children:"대기중"}),(0,a.jsx)("option",{children:"진행중"}),(0,a.jsx)("option",{children:"완료"})]})})]});return(0,a.jsxs)("div",{className:"animate-in fade-in",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"고객 문의 현황"}),(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(T.A,{})})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,a.jsx)("thead",{className:"bg-gray-50 text-gray-500 uppercase text-xs",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3",children:"날짜"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"고객 정보"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"관심 분야"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"메시지"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center",children:"첨부"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"상태"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsx)(l,{item:e},e.id))})]})})]})};var $=s(1914),L=s(8459),M=s(5243),E=s(4832),I=s(2230),O=s(2869),U=s(4928);let H=({hospitalsList:e,hospitalsError:t,handleEditHospital:s,editingHospitalId:r,setEditingHospitalId:l,hospitalForm:i,setHospitalForm:d,uploading:c,loading:x,handleSaveHospital:m,handleDelete:p,fetchHospitals:u,uploadToSupabase:g,DynamicListInput:h,ImageUploader:b,AddressInput:f,toast:y})=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-8 animate-in fade-in",children:[(0,a.jsxs)("div",{className:"col-span-4 bg-white rounded-2xl border border-gray-200 p-4 h-[calc(100vh-100px)] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"등록된 병원"}),(0,a.jsx)("button",{onClick:()=>{l(null),d({name:"",location_kr:"",location_en:"",address_detail:"",description:"",latitude:null,longitude:null,tags:[],images:[],languages:[],amenities:[],hoursMonFri:"",hoursSat:"",doctorName:"",doctorTitle:"",doctorImage:"",doctorSchool:"",doctorYears:"",doctorSpecialties:[],doctorMetricValue:"99%",doctorMetricLabel:"만족도",displayOrder:null,isPublished:!0})},className:"bg-teal-600 text-white p-1 rounded",children:(0,a.jsx)($.A,{size:16})})]}),!1,e.map(e=>{let t=e.location_kr||e.location_en||e.location||"";return(0,a.jsxs)("div",{onClick:()=>s(e),className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${r===e.id?"bg-teal-50 border-l-4 border-l-teal-500":""}`,children:[(0,a.jsx)("div",{className:"font-bold",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:t||""})]},e.id)})]}),(0,a.jsxs)("div",{className:"col-span-8 relative",children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 p-4 mb-4 rounded-t-2xl flex justify-between items-center shadow-sm",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:r?"병원 정보 수정":"신규 병원 등록"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[r&&(0,a.jsx)("button",{onClick:()=>p("hospitals",r,u),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition",title:"삭제",children:(0,a.jsx)(L.A,{size:20})}),(0,a.jsxs)("button",{onClick:m,disabled:x,className:"bg-teal-600 text-white px-6 py-2.5 rounded-lg font-bold shadow-md hover:bg-teal-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x?(0,a.jsx)(n.A,{size:18,className:"animate-spin"}):(0,a.jsx)(M.A,{size:18}),x?"저장 중...":"저장"]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 p-8 h-[calc(100vh-180px)] overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-400",children:"기본 정보 (필수)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"병원명 (영어/한국어)",value:i.name,onChange:e=>d({...i,name:e.target.value}),className:"w-full p-2 border rounded"}),(0,a.jsx)("input",{type:"number",placeholder:"메인 페이지 표시 순서 (숫자가 작을수록 앞에 표시, 비워두면 최신순)",value:i.displayOrder||"",onChange:e=>d({...i,displayOrder:e.target.value?e.target.value:null}),className:"w-full p-2 border rounded text-sm"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)("label",{className:"text-sm font-bold text-gray-700 flex-1",children:"프론트 노출 여부"}),(0,a.jsx)("button",{type:"button",onClick:()=>d({...i,isPublished:!i.isPublished}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i.isPublished?"bg-teal-600":"bg-gray-300"}`,children:(0,a.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.isPublished?"translate-x-6":"translate-x-1"}`})}),(0,a.jsx)("span",{className:"text-xs text-gray-600 w-16",children:i.isPublished?"노출":"숨김"})]}),(0,a.jsx)(f,{value:i.location_kr||"",onChange:e=>d({...i,location_kr:e}),onLocationSelect:e=>{e&&(d(t=>({...t,location_kr:e.koAddress||t.location_kr,location_en:e.enAddress||t.location_en})),y.success("주소가 입력되었습니다."))},placeholder:"한국어 주소를 검색하세요 (예: 강남구 테헤란로 123)",language:"ko"}),(0,a.jsx)("input",{type:"text",placeholder:"영문 주소 (자동 입력됨, 필요 시 수정)",value:i.location_en||"",onChange:e=>d({...i,location_en:e.target.value}),className:"w-full p-2 border rounded text-sm"}),(0,a.jsx)("input",{type:"text",placeholder:"상세 주소 (층/호수 등)",value:i.address_detail||"",onChange:e=>d({...i,address_detail:e.target.value}),className:"w-full p-2 border rounded text-sm"}),(0,a.jsx)("textarea",{placeholder:"병원 소개 (상세 페이지용 설명)",value:i.description,onChange:e=>d({...i,description:e.target.value}),className:"w-full p-2 border rounded",rows:"3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-teal-600 mb-2 flex items-center gap-1",children:[(0,a.jsx)(E.A,{size:14})," 통역 가능 언어"]}),(0,a.jsx)(h,{items:i.languages,onAdd:e=>d({...i,languages:[...i.languages,e]}),onRemove:e=>d({...i,languages:i.languages.filter((t,s)=>s!==e)}),placeholder:"예: 영어, 중국어"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-teal-600 mb-2 flex items-center gap-1",children:[(0,a.jsx)(I.A,{size:14})," 편의 시설"]}),(0,a.jsx)(h,{items:i.amenities,onAdd:e=>d({...i,amenities:[...i.amenities,e]}),onRemove:e=>d({...i,amenities:i.amenities.filter((t,s)=>s!==e)}),placeholder:"예: 와이파이, 픽업"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-400",children:"이미지 및 태그"}),(0,a.jsx)(h,{items:i.tags,onAdd:e=>d({...i,tags:[...i.tags,e]}),onRemove:e=>d({...i,tags:i.tags.filter((t,s)=>s!==e)}),placeholder:"태그 입력 (예: 피부과)"}),(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-500 mt-2",children:"병원 갤러리 이미지"}),(0,a.jsxs)("p",{className:"text-xs text-teal-600 bg-teal-50 p-2 rounded-lg mb-2 flex items-center gap-2",children:[(0,a.jsx)(_.A,{size:14})," \uD83D\uDCA1 권장: 1200x900px (4:3 비율)"]}),(0,a.jsx)(b,{images:i.images,onUpload:async e=>{let t=await g(e);t&&d(e=>({...e,images:[...e.images,t]}))},onRemove:e=>d(t=>({...t,images:t.images.filter((t,s)=>s!==e)})),uploading:c})]}),(0,a.jsxs)("div",{className:"space-y-3 bg-gray-50 p-4 rounded-xl border border-gray-100",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(O.A,{size:16})," 대표 원장 정보"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{placeholder:"이름 (영문/한글)",value:i.doctorName,onChange:e=>d({...i,doctorName:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"직함 (예: 대표원장)",value:i.doctorTitle,onChange:e=>d({...i,doctorTitle:e.target.value}),className:"border p-2 rounded"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{placeholder:"출신 학교 (예: 서울대)",value:i.doctorSchool,onChange:e=>d({...i,doctorSchool:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"경력 (예: 15년 이상)",value:i.doctorYears,onChange:e=>d({...i,doctorYears:e.target.value}),className:"border p-2 rounded"})]}),(0,a.jsx)(h,{items:i.doctorSpecialties,onAdd:e=>d({...i,doctorSpecialties:[...i.doctorSpecialties,e]}),onRemove:e=>d({...i,doctorSpecialties:i.doctorSpecialties.filter((t,s)=>s!==e)}),placeholder:"전문 분야 (예: 코성형)",icon:U.A}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("label",{className:"text-xs text-gray-400 font-bold mb-1 block",children:"원장님 프로필 사진"}),(0,a.jsx)("p",{className:"text-[10px] text-teal-600 mb-2",children:"\uD83D\uDCA1 1:1 정방형 (400x400px) 필수 - 얼굴이 중앙에 오도록"}),(0,a.jsx)("div",{className:"flex gap-2 items-center",children:i.doctorImage?(0,a.jsxs)("div",{className:"relative group w-16 h-16 rounded-full overflow-hidden border",children:[(0,a.jsx)("img",{src:i.doctorImage,alt:"doc",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{onClick:()=>d({...i,doctorImage:""}),className:"absolute inset-0 bg-black/50 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition",children:(0,a.jsx)(o.A,{size:16})})]}):(0,a.jsxs)("div",{onClick:()=>document.getElementById("doc-upload").click(),className:"w-16 h-16 rounded-full border border-dashed flex items-center justify-center text-gray-400 cursor-pointer hover:bg-white hover:border-teal-500",children:[c?(0,a.jsx)(n.A,{size:16,className:"animate-spin"}):(0,a.jsx)($.A,{size:16}),(0,a.jsx)("input",{id:"doc-upload",type:"file",accept:"image/*",className:"hidden",disabled:c,onChange:async e=>{let t=await g(e.target.files[0]);t&&d(e=>({...e,doctorImage:t}))}})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{placeholder:"평일 운영시간 (09:00 - 18:00)",value:i.hoursMonFri,onChange:e=>d({...i,hoursMonFri:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"주말 운영시간 (09:00 - 13:00)",value:i.hoursSat,onChange:e=>d({...i,hoursSat:e.target.value}),className:"border p-2 rounded"})]})]})})]})]}),D=({hospitalsList:e,selectedHospitalId:t,setSelectedHospitalId:s,fetchTreatments:r,treatmentsList:l,treatmentsError:i,editingTreatmentId:o,setEditingTreatmentId:d,treatmentForm:c,setTreatmentForm:x,handleEditTreatment:m,handleSaveTreatment:p,handleDelete:u,loading:g,uploadToSupabase:h,uploading:b,DynamicListInput:f,ImageUploader:y})=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-8 animate-in fade-in",children:[(0,a.jsxs)("div",{className:"col-span-4 bg-white rounded-2xl border border-gray-200 p-4 h-[calc(100vh-100px)] overflow-y-auto",children:[(0,a.jsxs)("select",{className:"w-full border p-2 rounded mb-4",value:t,onChange:e=>{s(e.target.value),r(e.target.value)},children:[(0,a.jsx)("option",{value:"",children:"병원을 먼저 선택하세요"}),e.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),!1,(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"시술 목록"}),t&&(0,a.jsx)("button",{onClick:()=>{d(null),x({title:"",desc:"",fullDescription:"",priceMin:"",recoveryTime:"",benefits:[],tags:[],images:[],displayOrder:null,isPublished:!0})},className:"bg-teal-600 text-white p-1 rounded",children:(0,a.jsx)($.A,{size:16})})]}),l.map(e=>(0,a.jsxs)("div",{onClick:()=>m(e),className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${o===e.id?"bg-teal-50 border-l-4 border-l-teal-500":""}`,children:[(0,a.jsx)("div",{className:"font-bold",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-teal-600",children:["$",e.price_min]})]},e.id))]}),(0,a.jsx)("div",{className:"col-span-8 relative",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 p-4 mb-4 rounded-t-2xl flex justify-between items-center shadow-sm",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:o?"시술 정보 수정":"신규 시술 등록"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[o&&(0,a.jsx)("button",{onClick:()=>u("treatments",o,()=>r(t)),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition",title:"삭제",children:(0,a.jsx)(L.A,{size:20})}),(0,a.jsxs)("button",{onClick:p,disabled:g,className:"bg-teal-600 text-white px-6 py-2.5 rounded-lg font-bold shadow-md hover:bg-teal-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[g?(0,a.jsx)(n.A,{size:18,className:"animate-spin"}):(0,a.jsx)(M.A,{size:18}),g?"저장 중...":"저장"]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 p-8 h-[calc(100vh-180px)] overflow-y-auto",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)("input",{placeholder:"시술명 (영어/한글)",value:c.title,onChange:e=>x({...c,title:e.target.value}),className:"w-full p-2 border rounded"})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"number",placeholder:"최소 가격 ($)",value:c.priceMin,onChange:e=>x({...c,priceMin:e.target.value}),className:"w-full p-2 border rounded"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(0,a.jsx)("input",{type:"number",placeholder:"메인 페이지 표시 순서 (숫자가 작을수록 앞에 표시, 비워두면 최신순)",value:c.displayOrder||"",onChange:e=>x({...c,displayOrder:e.target.value?e.target.value:null}),className:"w-full p-2 border rounded text-sm"})}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)("label",{className:"text-sm font-bold text-gray-700 flex-1",children:"프론트 노출 여부"}),(0,a.jsx)("button",{type:"button",onClick:()=>x({...c,isPublished:!c.isPublished}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${c.isPublished?"bg-teal-600":"bg-gray-300"}`,children:(0,a.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c.isPublished?"translate-x-6":"translate-x-1"}`})}),(0,a.jsx)("span",{className:"text-xs text-gray-600 w-16",children:c.isPublished?"노출":"숨김"})]}),(0,a.jsx)("input",{placeholder:"간략 설명 (카드용)",value:c.desc,onChange:e=>x({...c,desc:e.target.value}),className:"w-full p-2 border rounded"}),(0,a.jsx)("textarea",{placeholder:"상세 설명 (페이지용)",rows:"4",value:c.fullDescription,onChange:e=>x({...c,fullDescription:e.target.value}),className:"w-full p-2 border rounded"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{placeholder:"소요 시간 (예: 1시간)",value:c.recoveryTime,onChange:e=>x({...c,recoveryTime:e.target.value}),className:"w-full p-2 border rounded"}),(0,a.jsx)("input",{placeholder:"마취 방법",value:c.anesthesia,onChange:e=>x({...c,anesthesia:e.target.value}),className:"w-full p-2 border rounded"})]}),(0,a.jsx)(f,{items:c.benefits,onAdd:e=>x({...c,benefits:[...c.benefits,e]}),onRemove:e=>x({...c,benefits:c.benefits.filter((t,s)=>s!==e)}),placeholder:"주요 효과 (Benefit)"}),(0,a.jsx)(f,{items:c.tags,onAdd:e=>x({...c,tags:[...c.tags,e]}),onRemove:e=>x({...c,tags:c.tags.filter((t,s)=>s!==e)}),placeholder:"검색 태그"}),(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-500 mt-2",children:"시술 관련 이미지"}),(0,a.jsxs)("p",{className:"text-xs text-teal-600 bg-teal-50 p-2 rounded-lg mb-2 flex items-center gap-2",children:[(0,a.jsx)(_.A,{size:14})," \uD83D\uDCA1 권장: 800x600px (4:3 비율)"]}),(0,a.jsx)(y,{images:c.images,onUpload:async e=>{let t=await h(e);t&&x(e=>({...e,images:[...e.images,t]}))},onRemove:e=>x(t=>({...t,images:t.images.filter((t,s)=>s!==e)})),uploading:b})]})})]}):(0,a.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 p-8 h-[calc(100vh-100px)] flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center text-gray-400",children:"왼쪽에서 병원을 먼저 선택해주세요."})})})]}),R=({siteSettings:e,setSiteSettings:t,uploadToSupabase:s,uploading:r,handleSaveSettings:l,ImageUploader:i})=>(0,a.jsxs)("div",{className:"max-w-2xl bg-white rounded-2xl border border-gray-200 p-8 shadow-sm animate-in fade-in",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"text-teal-600"})," 사이트 디자인 설정"]}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"상단 로고 이미지 (Logo)"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"비워두면 텍스트(HEALO)가 표시됩니다. 투명 배경 PNG 추천."}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-3 p-4 bg-teal-600 rounded-lg",children:[(0,a.jsx)("span",{className:"text-white text-xs opacity-70",children:"미리보기 (Dark 배경):"}),e.logo_url?(0,a.jsx)("img",{src:e.logo_url,className:"h-8 object-contain",alt:"Logo Preview"}):(0,a.jsx)("span",{className:"text-xl font-extrabold text-white",children:"HEALO"})]}),(0,a.jsx)(i,{images:e.logo_url?[e.logo_url]:[],onUpload:async e=>{let a=await s(e);a&&t(e=>({...e,logo_url:a}))},onRemove:()=>t(e=>({...e,logo_url:null})),uploading:r})]}),(0,a.jsx)("hr",{className:"border-gray-100"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"메인 배경 이미지 (Hero Background)"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"메인 검색창 뒤에 깔리는 이미지입니다."}),e.hero_background_url&&(0,a.jsx)("div",{className:"mb-3 w-full h-40 rounded-lg overflow-hidden relative",children:(0,a.jsx)("img",{src:e.hero_background_url,className:"w-full h-full object-cover",alt:"Hero BG"})}),(0,a.jsx)(i,{images:e.hero_background_url?[e.hero_background_url]:[],onUpload:async e=>{let a=await s(e);a&&t(e=>({...e,hero_background_url:a}))},onRemove:()=>t(e=>({...e,hero_background_url:null})),uploading:r})]}),(0,a.jsx)("button",{onClick:l,className:"w-full bg-teal-600 text-white py-3 rounded-xl font-bold hover:bg-teal-700 transition shadow-lg",children:"설정 저장하기"})]})]}),F=({items:e,onAdd:t,onRemove:s,placeholder:l,icon:i})=>{let[n,d]=(0,r.useState)(""),c=()=>{n.trim()&&(t(n.trim()),d(""))};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[i&&(0,a.jsx)(i,{size:16,className:"absolute left-3 top-3 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),c()),className:`w-full p-2.5 rounded-lg border border-gray-200 text-sm focus:ring-2 focus:ring-teal-500 outline-none transition ${i?"pl-10":""}`,placeholder:l})]}),(0,a.jsx)("button",{type:"button",onClick:c,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 rounded-lg font-bold text-sm transition",children:"추가"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map((e,t)=>(0,a.jsxs)("span",{className:"bg-teal-50 text-teal-700 text-xs font-bold px-3 py-1.5 rounded-full flex items-center gap-2 border border-teal-100",children:[e," ",(0,a.jsx)("button",{type:"button",onClick:()=>s(t),className:"hover:text-red-500",children:(0,a.jsx)(o.A,{size:12})})]},t))})]})},B=({images:e,onUpload:t,onRemove:s,uploading:l})=>{let i=(0,r.useRef)(null),c=async e=>{let s=e.target.files[0];s&&(await t(s),i.current&&(i.current.value=""))};return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",ref:i,onChange:c,disabled:l,className:"hidden",id:"file-upload-input"}),(0,a.jsxs)("label",{onClick:()=>i.current.click(),className:`w-full flex items-center justify-center gap-2 p-3 rounded-lg border border-dashed border-gray-300 text-sm text-gray-500 cursor-pointer hover:bg-gray-50 hover:border-teal-500 transition ${l?"opacity-50 cursor-not-allowed":""}`,children:[l?(0,a.jsx)(n.A,{size:18,className:"animate-spin"}):(0,a.jsx)(d.A,{size:18}),l?"업로드 중...":"클릭하여 이미지 업로드 (JPG, PNG)"]})]})}),e.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"relative group aspect-square rounded-lg overflow-hidden border border-gray-200 bg-gray-100",children:[(0,a.jsx)("img",{src:e,alt:"upload",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{onClick:()=>s(t),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-80 hover:opacity-100 transition shadow-sm",children:(0,a.jsx)(o.A,{size:12})})]},t))})]})},Y=({setView:e})=>{let t=(0,f.d)(),[s,l]=(0,r.useState)("analytics"),[n,d]=(0,r.useState)(!1),[y,j]=(0,r.useState)(!1),[v,w]=(0,r.useState)([]),[_,k]=(0,r.useState)([]),[A,C]=(0,r.useState)([]),[S,z]=(0,r.useState)(null),[T,$]=(0,r.useState)(null),[L,M]=(0,r.useState)(null),[E,I]=(0,r.useState)({logo_url:"",hero_background_url:""}),[O,U]=(0,r.useState)({totalRevenue:0,totalLeads:0,topTreatment:"-",hospitalOpportunities:[],treatmentTrends:[]}),[Y,V]=(0,r.useState)(null),[K,G]=(0,r.useState)({name:"",location_kr:"",location_en:"",address_detail:"",description:"",latitude:null,longitude:null,tags:[],images:[],languages:[],amenities:[],hoursMonFri:"09:00 - 18:00",hoursSat:"09:00 - 13:00",doctorName:"",doctorTitle:"",doctorImage:"",doctorSchool:"",doctorYears:"",doctorSpecialties:[],doctorMetricValue:"99%",doctorMetricLabel:"만족도",displayOrder:null,isPublished:!0}),[X,Z]=(0,r.useState)(""),[J,Q]=(0,r.useState)(null),[W,ee]=(0,r.useState)({title:"",desc:"",fullDescription:"",priceMin:"",recoveryTime:"",benefits:[],tags:[],images:[],displayOrder:null,isPublished:!0}),et=async()=>{let{data:e}=await i.N.from("inquiries").select("*").order("created_at",{ascending:!1});w(e||[])},es=async()=>{let{data:e,error:t}=await i.N.from("hospitals").select("*").order("created_at",{ascending:!1});if(t){console.error("[AdminPage] Hospitals fetch error:",t),z(t),k([]);return}z(null),k(e||[])},ea=async e=>{if(!e)return;let{data:t,error:s}=await i.N.from("treatments").select("*").eq("hospital_id",e).order("created_at",{ascending:!1});if(s){console.error("[AdminPage] Treatments fetch error:",s),$(s),C([]);return}$(null),C(t||[])},er=async()=>{let{data:e}=await i.N.from("site_settings").select("*").single();e&&I(e)},el=async()=>{d(!0),await Promise.all([et(),es(),er()]),d(!1)};(0,r.useEffect)(()=>{(async()=>{let{data:{session:s}}=await i.N.auth.getSession();s&&"admin@healo.com"===s.user.email?el():(t.error("관리자 권한이 없습니다 \uD83D\uDEE1️"),e("login"))})()},[]),(0,r.useEffect)(()=>{if(0===v.length)return;let e={};v.forEach(t=>{let s=t.treatment_type||"General Inquiry";e[s]=(e[s]||0)+1});let t=Object.entries(e).sort(([,e],[,t])=>t-e).map(([e,t])=>({name:e,count:t,percent:Math.round(t/v.length*100)})),s={};v.forEach(e=>{let t=e.hospital_id||"unassigned";s[t]=(s[t]||0)+1});let a=Object.entries(s).map(([e,t])=>{let s=_.find(t=>t.id===e),a="unassigned"===e,r=s?.tags?.some(e=>String(e).toLowerCase().includes("partner"));return{id:e,name:s?s.name:a?"미지정 수요 (Floating Demand)":"Unknown",count:t,marketValue:3500*t,status:r?"매칭 완료":a?"기회 비용 (Missed)":"이탈 우려",action:r?"관계 유지 관리":a?"신규 제휴 제안 시급":"영업 타겟팅 대상"}}).sort((e,t)=>t.marketValue-e.marketValue);U({totalLeads:v.length,totalRevenue:3500*v.length,topTreatment:t[0]?.name||"-",hospitalOpportunities:a,treatmentTrends:t})},[v,_]);let ei=async(e,t)=>{await i.N.from("inquiries").update({status:t}).eq("id",e),et()},eo=async(e,s,a)=>{if(confirm("정말 삭제하시겠습니까? 복구할 수 없습니다."))try{let{error:r}=await i.N.from(e).delete().eq("id",s);if(r){console.error(`[AdminPage] Delete ${e} error:`,r),t.error("삭제 실패: "+r.message);return}t.success("삭제되었습니다."),a&&a()}catch(s){console.error(`[AdminPage] Delete ${e} exception:`,s),t.error("삭제 실패: "+s.message)}},en=e=>{let t=e.split(".").pop().toLowerCase();return["png","jpg","jpeg","gif","webp"].includes(t)?"image":"pdf"===t?"pdf":"other"},ed=async e=>{if(!e)return null;j(!0);try{let t=e.name.split(".").pop(),s=`${Date.now()}-${Math.random().toString(36).substring(2,10)}.${t}`,a=`uploads/${s}`,{error:r}=await i.N.storage.from("images").upload(a,e);if(r)throw r;let{data:l}=i.N.storage.from("images").getPublicUrl(a);return l.publicUrl}catch(e){return console.error("Upload failed:",e),t.error("이미지 업로드 실패: "+e.message),null}finally{j(!1)}},ec=async()=>{if(!K.name)return t.error("병원명은 필수입니다.");d(!0);let e=K.name.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")||`hospital-${Date.now()}`,s=Array.isArray(K.images)?K.images:K.images?[K.images]:[],a={name:K.name,slug:e,location_kr:K.location_kr?.trim()||null,location_en:K.location_en?.trim()||null,address_detail:K.address_detail?.trim()||null,description:K.description,latitude:K.latitude,longitude:K.longitude,tags:K.tags,images:s,supported_languages:K.languages,amenities:K.amenities,operating_hours:{mon_fri:K.hoursMonFri,sat:K.hoursSat},doctor_profile:{name:K.doctorName,title:K.doctorTitle,image:K.doctorImage,school:K.doctorSchool,years:K.doctorYears,specialties:K.doctorSpecialties,heroMetric:{value:K.doctorMetricValue,label:K.doctorMetricLabel}},display_order:K.displayOrder?Number(K.displayOrder):null,is_published:void 0===K.isPublished||K.isPublished};console.log("[AdminPage] Hospital payload:",{...a,images:s});try{let e;if(null!==a.display_order&&void 0!==a.display_order){let e=null;if(Y){let{data:t}=await i.N.from("hospitals").select("display_order").eq("id",Y).single();e=t?.display_order||null}let{data:t}=await i.N.from("hospitals").select("id, display_order").eq("display_order",a.display_order).neq("id",Y||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)if(null===e||a.display_order<e){let{data:t}=await i.N.from("hospitals").select("id, display_order").gte("display_order",a.display_order).lt("display_order",e||999999).neq("id",Y||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)for(let e of t)await i.N.from("hospitals").update({display_order:(e.display_order||0)+1}).eq("id",e.id)}else if(a.display_order>e){let{data:t}=await i.N.from("hospitals").select("id, display_order").gt("display_order",e||-1).lte("display_order",a.display_order).neq("id",Y||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)for(let e of t)await i.N.from("hospitals").update({display_order:(e.display_order||0)-1}).eq("id",e.id)}else{let{data:e}=await i.N.from("hospitals").select("id, display_order").eq("display_order",a.display_order).neq("id",Y||"00000000-0000-0000-0000-000000000000");if(e&&e.length>0)for(let t of e)await i.N.from("hospitals").update({display_order:(t.display_order||0)+1}).eq("id",t.id)}}if((e=Y?await i.N.from("hospitals").update(a).eq("id",Y):await i.N.from("hospitals").insert([a])).error){console.error("[AdminPage] Hospital save error:",e.error),t.error("저장 실패: "+e.error.message);return}t.success("병원 정보가 저장되었습니다! \uD83C\uDFE5"),V(null),await es(),G({name:"",location_kr:"",location_en:"",address_detail:"",description:"",latitude:null,longitude:null,tags:[],images:[],languages:[],amenities:[],hoursMonFri:"",hoursSat:"",doctorName:"",doctorTitle:"",doctorImage:"",doctorSchool:"",doctorYears:"",doctorSpecialties:[],doctorMetricValue:"99%",doctorMetricLabel:"만족도",displayOrder:null,isPublished:!0})}catch(e){console.error("[AdminPage] Hospital save exception:",e),t.error("저장 실패: "+e.message)}finally{d(!1)}},ex=async()=>{if(!X||!W.title)return t.error("병원 선택과 시술명은 필수입니다.");d(!0);let e=Array.isArray(W.images)?W.images:W.images?[W.images]:[],s={hospital_id:X,name:W.title,description:W.desc,full_description:W.fullDescription,price_min:Number(W.priceMin)||0,benefits:W.benefits,tags:W.tags,images:e,display_order:W.displayOrder?Number(W.displayOrder):null,is_published:void 0===W.isPublished||W.isPublished};console.log("[AdminPage] Treatment payload:",{...s,images:e});try{let e;if(null!==s.display_order&&void 0!==s.display_order){let e=null;if(J){let{data:t}=await i.N.from("treatments").select("display_order").eq("id",J).single();e=t?.display_order||null}let{data:t}=await i.N.from("treatments").select("id, display_order").eq("display_order",s.display_order).neq("id",J||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)if(null===e||s.display_order<e){let{data:t}=await i.N.from("treatments").select("id, display_order").gte("display_order",s.display_order).lt("display_order",e||999999).neq("id",J||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)for(let e of t)await i.N.from("treatments").update({display_order:(e.display_order||0)+1}).eq("id",e.id)}else if(s.display_order>e){let{data:t}=await i.N.from("treatments").select("id, display_order").gt("display_order",e||-1).lte("display_order",s.display_order).neq("id",J||"00000000-0000-0000-0000-000000000000");if(t&&t.length>0)for(let e of t)await i.N.from("treatments").update({display_order:(e.display_order||0)-1}).eq("id",e.id)}else{let{data:e}=await i.N.from("treatments").select("id, display_order").eq("display_order",s.display_order).neq("id",J||"00000000-0000-0000-0000-000000000000");if(e&&e.length>0)for(let t of e)await i.N.from("treatments").update({display_order:(t.display_order||0)+1}).eq("id",t.id)}}if((e=J?await i.N.from("treatments").update(s).eq("id",J):await i.N.from("treatments").insert([s])).error){console.error("[AdminPage] Treatment save error:",e.error),t.error("저장 실패: "+e.error.message);return}t.success("시술 정보가 저장되었습니다! \uD83D\uDC89"),Q(null),await ea(X),ee({title:"",desc:"",fullDescription:"",priceMin:"",recoveryTime:"",benefits:[],tags:[],images:[],displayOrder:null,isPublished:!0})}catch(e){console.error("[AdminPage] Treatment save exception:",e),t.error("저장 실패: "+e.message)}finally{d(!1)}},em=async()=>{d(!0);let{error:e}=await i.N.from("site_settings").update({logo_url:E.logo_url,hero_background_url:E.hero_background_url}).eq("id",E.id);e?t.error("저장 실패: "+e.message):t.success("사이트 설정이 저장되었습니다! \uD83C\uDFA8"),d(!1)};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,a.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 fixed h-full p-6 flex flex-col z-20",children:[(0,a.jsxs)("div",{className:"text-2xl font-black text-teal-600 mb-10 flex items-center gap-2",children:[(0,a.jsx)(c.A,{})," 관리자 모드"]}),(0,a.jsxs)("nav",{className:"space-y-2 flex-1",children:[(0,a.jsxs)("button",{onClick:()=>l("analytics"),className:`w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition ${"analytics"===s?"bg-teal-50 text-teal-700":"text-gray-500 hover:bg-gray-50"}`,children:[(0,a.jsx)(x.A,{size:18})," 시장 분석 (통계)"]}),(0,a.jsxs)("button",{onClick:()=>l("inquiries"),className:`w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition ${"inquiries"===s?"bg-teal-50 text-teal-700":"text-gray-500 hover:bg-gray-50"}`,children:[(0,a.jsx)(m.A,{size:18})," 고객 문의"]}),(0,a.jsxs)("button",{onClick:()=>l("hospitals"),className:`w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition ${"hospitals"===s?"bg-teal-50 text-teal-700":"text-gray-500 hover:bg-gray-50"}`,children:[(0,a.jsx)(p.A,{size:18})," 병원 관리"]}),(0,a.jsxs)("button",{onClick:()=>l("treatments"),className:`w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition ${"treatments"===s?"bg-teal-50 text-teal-700":"text-gray-500 hover:bg-gray-50"}`,children:[(0,a.jsx)(u.A,{size:18})," 시술 관리"]}),(0,a.jsxs)("div",{className:"pt-4 mt-4 border-t border-gray-100 space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>l("settings"),className:`w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition ${"settings"===s?"bg-teal-50 text-teal-700":"text-gray-500 hover:bg-gray-50"}`,children:[(0,a.jsx)(g.A,{size:18})," 사이트 설정"]}),(0,a.jsxs)("a",{href:"/admin/rag",className:"w-full text-left px-4 py-3 rounded-xl font-bold flex items-center gap-3 transition text-gray-500 hover:bg-gray-50",children:[(0,a.jsx)(h.A,{size:18})," RAG 테스트"]})]})]}),(0,a.jsxs)("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-400 hover:text-red-500 font-bold px-2 py-2",children:[(0,a.jsx)(b.A,{size:16})," 관리자 나가기"]})]}),(0,a.jsxs)("div",{className:"ml-64 flex-1 p-8 md:p-12 max-w-7xl",children:["analytics"===s&&(0,a.jsx)(P,{analytics:O}),"inquiries"===s&&(0,a.jsx)(q,{inquiries:v,fetchInquiries:et,handleStatusChange:ei,handleFileClick:e=>{M(e)}}),"hospitals"===s&&(0,a.jsx)(H,{hospitalsList:_,hospitalsError:S,handleEditHospital:e=>{V(e.id);let t=e.doctor_profile||{},s=Array.isArray(e.images)?e.images:e.images?[e.images]:[];console.log("[AdminPage] Editing hospital:",{id:e.id,name:e.name,images:e.images,imagesArray:s}),G({name:e.name,location_kr:e.location_kr||e.location||"",location_en:e.location_en||e.location||"",address_detail:e.address_detail||"",description:e.description,latitude:e.latitude||null,longitude:e.longitude||null,tags:e.tags||[],images:s,languages:e.supported_languages||[],amenities:e.amenities||[],hoursMonFri:e.operating_hours?.mon_fri||"",hoursSat:e.operating_hours?.sat||"",doctorName:t.name||"",doctorTitle:t.title||"",doctorImage:t.image||"",doctorSchool:t.school||"",doctorYears:t.years||"",doctorSpecialties:t.specialties||[],doctorMetricValue:t.heroMetric?.value||"99%",doctorMetricLabel:t.heroMetric?.label||"만족도",displayOrder:e.display_order||null,isPublished:void 0===e.is_published||e.is_published})},editingHospitalId:Y,setEditingHospitalId:V,hospitalForm:K,setHospitalForm:G,uploading:y,loading:n,handleSaveHospital:ec,handleDelete:eo,fetchHospitals:es,uploadToSupabase:ed,DynamicListInput:F,ImageUploader:B,AddressInput:N,toast:t}),"treatments"===s&&(0,a.jsx)(D,{hospitalsList:_,selectedHospitalId:X,setSelectedHospitalId:Z,fetchTreatments:ea,treatmentsList:A,treatmentsError:T,editingTreatmentId:J,setEditingTreatmentId:Q,treatmentForm:W,setTreatmentForm:ee,handleEditTreatment:e=>{Q(e.id);let t=Array.isArray(e.images)?e.images:e.images?[e.images]:[];console.log("[AdminPage] Editing treatment:",{id:e.id,name:e.name,images:e.images,imagesArray:t}),ee({title:e.name,desc:e.description,fullDescription:e.full_description||"",priceMin:e.price_min,recoveryTime:e.recovery_time||"",benefits:e.benefits||[],tags:e.tags||[],images:t,displayOrder:e.display_order||null,isPublished:void 0===e.is_published||e.is_published})},handleSaveTreatment:ex,handleDelete:eo,loading:n,uploadToSupabase:ed,uploading:y,DynamicListInput:F,ImageUploader:B}),"settings"===s&&(0,a.jsx)(R,{siteSettings:E,setSiteSettings:I,uploadToSupabase:ed,uploading:y,handleSaveSettings:em,ImageUploader:B})]}),L&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100]",onClick:()=>M(null),children:(0,a.jsxs)("div",{className:"bg-white rounded-xl p-5 max-w-6xl w-full h-[85vh] flex flex-col relative",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"미리보기"}),(0,a.jsx)("button",{onClick:()=>M(null),children:(0,a.jsx)(o.A,{size:20})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto border rounded-lg bg-gray-50 p-4 flex justify-center items-start",children:["image"===en(L)&&(0,a.jsx)("img",{src:L,className:"max-w-full max-h-full",alt:"preview"}),"pdf"===en(L)&&(0,a.jsx)("iframe",{src:L,className:"w-full h-full border",title:"pdf"}),"other"===en(L)&&(0,a.jsx)("a",{href:L,target:"_blank",rel:"noopener noreferrer",className:"text-teal-600 underline",children:"새 창에서 열기"})]})]})})]})};function V(){let e=(0,l.useRouter)(),t=(0,r.useMemo)(()=>t=>{switch(t){case"home":default:e.push("/");break;case"list_treatment":e.push("/treatments");break;case"list_hospital":e.push("/hospitals");break;case"admin":e.push("/admin");break;case"inquiry":e.push("/inquiry");break;case"login":e.push("/login");break;case"signup":e.push("/signup")}},[e]);return(0,a.jsx)(Y,{setView:t})}}},e=>{e.O(0,[436,121,358],()=>e(e.s=7996)),_N_E=e.O()}]);