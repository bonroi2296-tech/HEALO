{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/rag/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl =\n  process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !serviceKey) {\n  const missing = [];\n  if (!supabaseUrl) missing.push(\"NEXT_PUBLIC_SUPABASE_URL/VITE_SUPABASE_URL\");\n  if (!serviceKey) missing.push(\"SUPABASE_SERVICE_ROLE_KEY\");\n  throw new Error(`Supabase admin env missing: ${missing.join(\", \")}`);\n}\n\nexport const supabaseAdmin = createClient(supabaseUrl, serviceKey, {\n  auth: { persistSession: false },\n});\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cACJ,gFAAwC,QAAQ,GAAG,CAAC,iBAAiB;AACvE,MAAM,aAAa,QAAQ,GAAG,CAAC,yBAAyB;AAExD,IAAI,CAAC,eAAe,CAAC,YAAY;IAC/B,MAAM,UAAU,EAAE;IAClB;;IACA,IAAI,CAAC,YAAY,QAAQ,IAAI,CAAC;IAC9B,MAAM,IAAI,MAAM,CAAC,4BAA4B,EAAE,QAAQ,IAAI,CAAC,OAAO;AACrE;AAEO,MAAM,gBAAgB,IAAA,gMAAY,EAAC,aAAa,YAAY;IACjE,MAAM;QAAE,gBAAgB;IAAM;AAChC"}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/intakeSchema.ts"],"sourcesContent":["/**\n * IntakeSchema — normalized_inquiries.constraints 고정 스키마\n * AI Agent(/api/chat) + Inquiry Form(/api/inquiry/normalize) 공통 적재용\n */\n\nexport type Intake = {\n  goal: string | null;\n  chief_complaint: string | null;\n  body_part: string | null;\n  duration: string | null;\n  severity: string | null;\n  budget: string | null;\n  timeline: string | null;\n  contraindications: string[] | null;\n  medical_history_flag: boolean | null;\n  medications_flag: boolean | null;\n  allergy_flag: boolean | null;\n  previous_procedure_flag: boolean | null;\n  attachments_present: boolean | null;\n};\n\nexport type IntakeMeta = {\n  pipeline_version: string;\n  source_type: \"ai_agent\" | \"inquiry_form\";\n  model: string | null;\n  prompt_version: string | null;\n};\n\n/** 필수 6개 — 누락 판단 기준 */\nconst REQUIRED_KEYS: (keyof Intake)[] = [\n  \"goal\",\n  \"chief_complaint\",\n  \"body_part\",\n  \"timeline\",\n  \"budget\",\n  \"attachments_present\",\n];\n\n/**\n * 빈 Intake + Meta 기본값\n */\nexport function createEmptyIntake(\n  source_type: \"ai_agent\" | \"inquiry_form\" = \"ai_agent\"\n): { intake: Intake; meta: IntakeMeta } {\n  const intake: Intake = {\n    goal: null,\n    chief_complaint: null,\n    body_part: null,\n    duration: null,\n    severity: null,\n    budget: null,\n    timeline: null,\n    contraindications: null,\n    medical_history_flag: null,\n    medications_flag: null,\n    allergy_flag: null,\n    previous_procedure_flag: null,\n    attachments_present: null,\n  };\n  const meta: IntakeMeta = {\n    pipeline_version: \"v1\",\n    source_type,\n    model: null,\n    prompt_version: null,\n  };\n  return { intake, meta };\n}\n\n/**\n * 누락 필드 목록 (필수 6개 기준)\n */\nexport function computeMissingFields(intake: Intake): string[] {\n  const missing: string[] = [];\n  for (const k of REQUIRED_KEYS) {\n    const v = intake[k];\n    if (k === \"attachments_present\") {\n      if (v === null || v === undefined) missing.push(k);\n      continue;\n    }\n    if (v === null || v === undefined || (typeof v === \"string\" && !String(v).trim())) {\n      missing.push(k);\n    }\n  }\n  return missing;\n}\n\n/**\n * 추출 신뢰도 0~1 (필수 6개 중 채워진 비율)\n */\nexport function computeExtractionConfidence(\n  intake: Intake,\n  missing_fields: string[]\n): number {\n  const filled = REQUIRED_KEYS.length - missing_fields.length;\n  if (filled <= 0) return 0;\n  return Math.min(1, Math.round((filled / REQUIRED_KEYS.length) * 100) / 100);\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAyBD,qBAAqB,GACrB,MAAM,gBAAkC;IACtC;IACA;IACA;IACA;IACA;IACA;CACD;AAKM,SAAS,kBACd,cAA2C,UAAU;IAErD,MAAM,SAAiB;QACrB,MAAM;QACN,iBAAiB;QACjB,WAAW;QACX,UAAU;QACV,UAAU;QACV,QAAQ;QACR,UAAU;QACV,mBAAmB;QACnB,sBAAsB;QACtB,kBAAkB;QAClB,cAAc;QACd,yBAAyB;QACzB,qBAAqB;IACvB;IACA,MAAM,OAAmB;QACvB,kBAAkB;QAClB;QACA,OAAO;QACP,gBAAgB;IAClB;IACA,OAAO;QAAE;QAAQ;IAAK;AACxB;AAKO,SAAS,qBAAqB,MAAc;IACjD,MAAM,UAAoB,EAAE;IAC5B,KAAK,MAAM,KAAK,cAAe;QAC7B,MAAM,IAAI,MAAM,CAAC,EAAE;QACnB,IAAI,MAAM,uBAAuB;YAC/B,IAAI,MAAM,QAAQ,MAAM,WAAW,QAAQ,IAAI,CAAC;YAChD;QACF;QACA,IAAI,MAAM,QAAQ,MAAM,aAAc,OAAO,MAAM,YAAY,CAAC,OAAO,GAAG,IAAI,IAAK;YACjF,QAAQ,IAAI,CAAC;QACf;IACF;IACA,OAAO;AACT;AAKO,SAAS,4BACd,MAAc,EACd,cAAwB;IAExB,MAAM,SAAS,cAAc,MAAM,GAAG,eAAe,MAAM;IAC3D,IAAI,UAAU,GAAG,OAAO;IACxB,OAAO,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,AAAC,SAAS,cAAc,MAAM,GAAI,OAAO;AACzE"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/intakeExtract.ts"],"sourcesContent":["/**\n * Intake 추출용 키워드/패턴 유틸 (normalize + chat 공용)\n */\n\nconst BODY_PART_KEYWORDS: [RegExp | string, string][] = [\n  [/nose|rhinoplasty|nasal/i, \"nose\"],\n  [/skin|acne|facial|laser|botox|filler/i, \"skin\"],\n  [/breast|augmentation|implants/i, \"breast\"],\n  [/hair|transplant|follicle/i, \"hair\"],\n  [/eye|lasik|eyelid|double eyelid/i, \"eye\"],\n  [/abdomen|tummy|liposuction|belly/i, \"abdomen\"],\n  [/chin|jaw/i, \"chin\"],\n  [/dental|implant|tooth|teeth/i, \"dental\"],\n];\n\nconst CONTRAINDICATION_KEYWORDS: [RegExp | string, string][] = [\n  [/allergy|allergic/i, \"allergy\"],\n  [/medication|medicine|meds|drug/i, \"medication\"],\n  [/diabetes|diabetic/i, \"diabetes\"],\n  [/pregnant|pregnancy/i, \"pregnant\"],\n];\n\nexport function bodyPartFromText(text: string | null | undefined): string | null {\n  const s = String(text || \"\").toLowerCase();\n  if (!s) return null;\n  for (const [pattern, part] of BODY_PART_KEYWORDS) {\n    if (typeof pattern === \"string\" ? s.includes(pattern) : pattern.test(s)) return part;\n  }\n  return null;\n}\n\nexport function contraindicationsAndFlagsFromMessage(\n  message: string | null | undefined\n): { contraindications: string[]; allergy: boolean; medications: boolean } {\n  const s = String(message || \"\").toLowerCase();\n  const contraindications: string[] = [];\n  let allergy = false;\n  let medications = false;\n  for (const [pattern, label] of CONTRAINDICATION_KEYWORDS) {\n    const match = typeof pattern === \"string\" ? s.includes(pattern) : pattern.test(s);\n    if (match) {\n      contraindications.push(label);\n      if (label === \"allergy\") allergy = true;\n      if (label === \"medication\") medications = true;\n    }\n  }\n  return { contraindications, allergy, medications };\n}\n\n/** query에서 timeline 추출 (asap, 1-3m, preferred_date 등) */\nexport function extractTimelineFromQuery(q: string): string | null {\n  const s = String(q || \"\").toLowerCase();\n  if (/\\basap\\b|as soon|urgent/i.test(s)) return \"asap\";\n  if (/1-3\\s*month|1\\s*to\\s*3\\s*m|within 3\\s*m/i.test(s)) return \"1-3m\";\n  if (/3-6\\s*month|3\\s*to\\s*6\\s*m/i.test(s)) return \"3-6m\";\n  if (/6\\s*month|6m\\+|6m\\s*plus/i.test(s)) return \"6m+\";\n  const iso = s.match(/\\b(20\\d{2})-(\\d{2})-(\\d{2})\\b/);\n  if (iso) return `preferred_date:${iso[0]}`;\n  const us = s.match(/\\b(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})\\b/);\n  if (us) return `preferred_date:${us[3]}-${us[1].padStart(2, \"0\")}-${us[2].padStart(2, \"0\")}`;\n  return null;\n}\n\n/** query에서 budget 추출 */\nexport function extractBudgetFromQuery(q: string): string | null {\n  const s = String(q || \"\").toLowerCase();\n  if (/\\bbudget\\b|price|cost|usd|won|\\$|₩|krw/i.test(s)) {\n    const m = s.match(/(\\d[\\d,.]*)\\s*(k|m|million|thousand)?\\s*(usd|won|krw|\\$|₩)?/i);\n    if (m) return m[0].trim().slice(0, 50);\n    return \"mentioned\";\n  }\n  return null;\n}\n\n/** query에서 duration 추출 (1w, 1m, 3m, 6m, 1y+) */\nexport function extractDurationFromQuery(q: string): string | null {\n  const s = String(q || \"\").toLowerCase();\n  if (/\\b1w\\b|1\\s*week/i.test(s)) return \"1w\";\n  if (/\\b1m\\b|1\\s*month/i.test(s)) return \"1m\";\n  if (/\\b3m\\b|3\\s*month/i.test(s)) return \"3m\";\n  if (/\\b6m\\b|6\\s*month/i.test(s)) return \"6m\";\n  if (/\\b1y\\b|1\\s*year|1y\\+/i.test(s)) return \"1y+\";\n  return null;\n}\n\n/** query에서 severity 추출 */\nexport function extractSeverityFromQuery(q: string): string | null {\n  const s = String(q || \"\").toLowerCase();\n  if (/\\bmild\\b|minor|slight/i.test(s)) return \"mild\";\n  if (/\\bmedium\\b|moderate/i.test(s)) return \"medium\";\n  if (/\\bsevere\\b|serious|bad/i.test(s)) return \"severe\";\n  const scale = s.match(/\\b([0-9]|10)\\s*\\/\\s*10\\b|\\b([0-9]|10)-10\\b/);\n  if (scale) return scale[0].slice(0, 20);\n  return null;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/app/api/inquiry/normalize/route.ts"],"sourcesContent":["import { supabaseAdmin } from \"../../../../src/lib/rag/supabaseAdmin\";\nimport {\n  createEmptyIntake,\n  computeMissingFields,\n  computeExtractionConfidence,\n  type Intake,\n  type IntakeMeta,\n} from \"../../../../src/lib/intakeSchema\";\nimport {\n  bodyPartFromText,\n  contraindicationsAndFlagsFromMessage,\n} from \"../../../../src/lib/intakeExtract\";\n\nconst detectLanguage = (value: string | null | undefined) => {\n  const v = String(value || \"\").toLowerCase();\n  if (v.includes(\"ko\") || v.includes(\"kr\") || v.includes(\"korean\")) return \"ko\";\n  if (v.includes(\"ja\") || v.includes(\"jp\") || v.includes(\"japanese\")) return \"ja\";\n  return \"en\";\n};\n\nfunction buildIntakeFromForm(row: {\n  message?: string | null;\n  treatment_type?: string | null;\n  preferred_date?: string | null;\n  attachment?: string | null;\n}): Intake {\n  const { intake } = createEmptyIntake(\"inquiry_form\");\n  try {\n    const msg = row?.message ?? null;\n    const tt = row?.treatment_type ?? null;\n    const pref = row?.preferred_date ?? null;\n    const att = row?.attachment ?? null;\n\n    intake.chief_complaint = msg ? String(msg).trim().slice(0, 2000) : null;\n    intake.goal = tt ? String(tt) : (msg ? String(msg).trim().split(/\\n/)[0]?.slice(0, 300) || null : null);\n    intake.body_part = bodyPartFromText(tt || msg) ?? null;\n    intake.timeline = pref\n      ? `preferred_date:${String(pref).slice(0, 10)}`\n      : null;\n    intake.budget = null;\n    intake.duration = null;\n    intake.severity = null;\n\n    const { contraindications, allergy, medications } = contraindicationsAndFlagsFromMessage(msg);\n    intake.contraindications = contraindications.length ? contraindications : null;\n    intake.allergy_flag = allergy || null;\n    intake.medications_flag = medications || null;\n    intake.medical_history_flag = null;\n    intake.previous_procedure_flag = null;\n    intake.attachments_present = !!att;\n  } catch {\n    /* no-op: use empty intake */\n  }\n  return intake;\n}\n\nfunction buildIntakeFromTextOnly(text: string): Intake {\n  const { intake } = createEmptyIntake(\"ai_agent\");\n  try {\n    const s = String(text || \"\").trim().slice(0, 300);\n    intake.chief_complaint = s || null;\n    intake.goal = null;\n    intake.body_part = bodyPartFromText(text) ?? null;\n    intake.timeline = null;\n    intake.budget = null;\n    intake.duration = null;\n    intake.severity = null;\n    const { contraindications, allergy, medications } = contraindicationsAndFlagsFromMessage(text);\n    intake.contraindications = contraindications.length ? contraindications : null;\n    intake.allergy_flag = allergy || null;\n    intake.medications_flag = medications || null;\n    intake.medical_history_flag = null;\n    intake.previous_procedure_flag = null;\n    intake.attachments_present = false;\n  } catch {\n    /* no-op */\n  }\n  return intake;\n}\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json().catch(() => ({}));\n    const text = body?.text ? String(body.text) : \"\";\n    const inquiryId = body?.inquiry_id != null ? Number(body.inquiry_id) : null;\n    const sourceTypePayload = body?.source_type === \"inquiry_form\" ? \"inquiry_form\" : null;\n    const sourceInquiryIdPayload = body?.source_inquiry_id != null ? Number(body.source_inquiry_id) : null;\n    const sessionId = body?.session_id != null ? String(body.session_id) : null;\n    const page = body?.page != null ? String(body.page) : null;\n    const utm = body?.utm && typeof body.utm === \"object\" ? body.utm : null;\n\n    const hasInquiryId = inquiryId != null || sourceInquiryIdPayload != null;\n    if (!text && !hasInquiryId) {\n      return Response.json(\n        { ok: false, error: \"text_or_inquiry_id_required\" },\n        { status: 400 }\n      );\n    }\n\n    if (sourceTypePayload === \"inquiry_form\" && !hasInquiryId) {\n      console.warn(\"[api/inquiry/normalize] inquiry_form requires inquiry_id / source_inquiry_id\");\n      return Response.json(\n        { ok: false, error: \"inquiry_id_required_for_inquiry_form\" },\n        { status: 400 }\n      );\n    }\n\n    const effectiveInquiryId = inquiryId ?? sourceInquiryIdPayload;\n\n    let inquiryRow: any = null;\n    if (effectiveInquiryId) {\n      const { data, error } = await supabaseAdmin\n        .from(\"inquiries\")\n        .select(\n          \"id, first_name, last_name, email, nationality, spoken_language, contact_method, contact_id, treatment_type, message, preferred_date, attachment\"\n        )\n        .eq(\"id\", effectiveInquiryId)\n        .single();\n      if (error) {\n        console.error(\"[api/inquiry/normalize] inquiries fetch error:\", error);\n        return Response.json(\n          { ok: false, error: error?.message || \"inquiry_fetch_failed\" },\n          { status: 500 }\n        );\n      }\n      inquiryRow = data;\n    }\n\n    const rawMessage = text || inquiryRow?.message || null;\n    const language = detectLanguage(inquiryRow?.spoken_language);\n    const sourceType = inquiryRow ? \"inquiry_form\" : \"ai_agent\";\n\n    let intake: Intake;\n    if (inquiryRow) {\n      intake = buildIntakeFromForm(inquiryRow);\n    } else {\n      intake = buildIntakeFromTextOnly(text);\n    }\n\n    const meta: IntakeMeta = {\n      pipeline_version: \"v1\",\n      source_type: sourceType,\n      model: null,\n      prompt_version: null,\n    };\n\n    const missing_fields = computeMissingFields(intake);\n    const extraction_confidence = computeExtractionConfidence(intake, missing_fields);\n\n    const constraints: Record<string, unknown> = {\n      intake,\n      meta,\n    };\n    if (sessionId != null) constraints.session_id = sessionId;\n    if (page != null) constraints.page = page;\n    if (utm != null) constraints.utm = utm;\n\n    const { data: inserted, error: insertError } = await supabaseAdmin\n      .from(\"normalized_inquiries\")\n      .insert({\n        source_type: sourceType,\n        source_inquiry_id: inquiryRow ? inquiryRow.id : null,\n        language,\n        country: inquiryRow?.nationality ?? null,\n        treatment_slug: inquiryRow?.treatment_type ?? null,\n        objective: null,\n        constraints,\n        raw_message: rawMessage,\n        extraction_confidence,\n        missing_fields: missing_fields.length ? missing_fields : null,\n        contact: inquiryRow\n          ? {\n              email: inquiryRow.email ?? null,\n              messenger_channel: inquiryRow.contact_method ?? null,\n              messenger_handle: inquiryRow.contact_id ?? null,\n            }\n          : null,\n      })\n      .select(\"*\")\n      .single();\n\n    if (insertError) {\n      console.error(\"[api/inquiry/normalize] normalized_inquiries insert failed:\", insertError);\n      return Response.json({ ok: true, normalized: null });\n    }\n\n    return Response.json({ ok: true, normalized: inserted });\n  } catch (error: any) {\n    console.error(\"[api/inquiry/normalize] error:\", error);\n    return Response.json(\n      { ok: false, error: error?.message || \"normalize_failed\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}