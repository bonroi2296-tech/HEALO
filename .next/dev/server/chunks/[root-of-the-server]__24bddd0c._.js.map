{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/rag/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl =\n  process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl || !serviceKey) {\n  const missing = [];\n  if (!supabaseUrl) missing.push(\"NEXT_PUBLIC_SUPABASE_URL/VITE_SUPABASE_URL\");\n  if (!serviceKey) missing.push(\"SUPABASE_SERVICE_ROLE_KEY\");\n  throw new Error(`Supabase admin env missing: ${missing.join(\", \")}`);\n}\n\nexport const supabaseAdmin = createClient(supabaseUrl, serviceKey, {\n  auth: { persistSession: false },\n});\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cACJ,gFAAwC,QAAQ,GAAG,CAAC,iBAAiB;AACvE,MAAM,aAAa,QAAQ,GAAG,CAAC,yBAAyB;AAExD,IAAI,CAAC,eAAe,CAAC,YAAY;IAC/B,MAAM,UAAU,EAAE;IAClB;;IACA,IAAI,CAAC,YAAY,QAAQ,IAAI,CAAC;IAC9B,MAAM,IAAI,MAAM,CAAC,4BAA4B,EAAE,QAAQ,IAAI,CAAC,OAAO;AACrE;AAEO,MAAM,gBAAgB,IAAA,gMAAY,EAAC,aAAa,YAAY;IACjE,MAAM;QAAE,gBAAgB;IAAM;AAChC"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/rag/buildDocument.ts"],"sourcesContent":["type SourceType =\n  | \"treatment\"\n  | \"hospital\"\n  | \"review\"\n  | \"normalized_inquiry\"\n  | \"policy\"\n  | \"faq\";\n\ntype BuildInput = {\n  source_type: SourceType;\n  source_id: string;\n  lang: string;\n  title: string | null;\n  content: string;\n};\n\nconst joinLines = (lines: Array<string | null | undefined>) =>\n  lines.filter(Boolean).join(\"\\n\").trim();\n\nexport const buildDocument = (sourceType: SourceType, row: any): BuildInput => {\n  switch (sourceType) {\n    case \"treatment\": {\n      // Fields used:\n      // id, slug, name, description, full_description, tags, benefits,\n      // price_min, price_max, hospitals.name, hospitals.location_en/location_kr\n      const title = row?.name || null;\n      const content = joinLines([\n        `Treatment: ${row?.name || \"\"}`,\n        row?.slug ? `Slug: ${row.slug}` : null,\n        row?.description ? `Summary: ${row.description}` : null,\n        row?.full_description ? `Details: ${row.full_description}` : null,\n        row?.tags?.length ? `Tags: ${row.tags.join(\", \")}` : null,\n        row?.benefits?.length ? `Benefits: ${row.benefits.join(\", \")}` : null,\n        row?.price_min != null ? `Price Min: ${row.price_min}` : null,\n        row?.price_max != null ? `Price Max: ${row.price_max}` : null,\n        row?.hospitals?.name ? `Hospital: ${row.hospitals.name}` : null,\n        row?.hospitals?.location_en\n          ? `Hospital Location (EN): ${row.hospitals.location_en}`\n          : null,\n        row?.hospitals?.location_kr\n          ? `Hospital Location (KR): ${row.hospitals.location_kr}`\n          : null,\n      ]);\n      return {\n        source_type: sourceType,\n        source_id: row.id,\n        lang: \"en\",\n        title,\n        content,\n      };\n    }\n    case \"hospital\": {\n      // Fields used:\n      // id, slug, name, description, location_en, location_kr, address_detail,\n      // tags, operating_hours, doctor_profile\n      const title = row?.name || null;\n      const content = joinLines([\n        `Hospital: ${row?.name || \"\"}`,\n        row?.slug ? `Slug: ${row.slug}` : null,\n        row?.description ? `Summary: ${row.description}` : null,\n        row?.location_en ? `Location (EN): ${row.location_en}` : null,\n        row?.location_kr ? `Location (KR): ${row.location_kr}` : null,\n        row?.address_detail ? `Address Detail: ${row.address_detail}` : null,\n        row?.tags?.length ? `Tags: ${row.tags.join(\", \")}` : null,\n        row?.operating_hours\n          ? `Operating Hours: ${JSON.stringify(row.operating_hours)}`\n          : null,\n        row?.doctor_profile ? `Doctor Profile: ${row.doctor_profile}` : null,\n      ]);\n      return {\n        source_type: sourceType,\n        source_id: row.id,\n        lang: \"en\",\n        title,\n        content,\n      };\n    }\n    case \"review\": {\n      // Fields used:\n      // id, treatment_id, user_name, country, rating, content, created_at\n      const title = row?.user_name\n        ? `Review by ${row.user_name}`\n        : \"Review\";\n      const content = joinLines([\n        row?.treatment_id ? `Treatment ID: ${row.treatment_id}` : null,\n        row?.user_name ? `User: ${row.user_name}` : null,\n        row?.country ? `Country: ${row.country}` : null,\n        row?.rating != null ? `Rating: ${row.rating}` : null,\n        row?.created_at ? `Created: ${row.created_at}` : null,\n        row?.content ? `Review: ${row.content}` : null,\n      ]);\n      return {\n        source_type: sourceType,\n        source_id: row.id,\n        lang: \"en\",\n        title,\n        content,\n      };\n    }\n    case \"normalized_inquiry\": {\n      // Fields used:\n      // id, language, country, treatment_id, treatment_slug, objective,\n      // constraints, raw_message, extraction_confidence, missing_fields, contact\n      const title =\n        row?.objective ||\n        (row?.treatment_slug ? `Inquiry about ${row.treatment_slug}` : null) ||\n        \"Inquiry\";\n      const content = joinLines([\n        row?.language ? `Language: ${row.language}` : null,\n        row?.country ? `Country: ${row.country}` : null,\n        row?.treatment_id ? `Treatment ID: ${row.treatment_id}` : null,\n        row?.treatment_slug ? `Treatment Slug: ${row.treatment_slug}` : null,\n        row?.objective ? `Objective: ${row.objective}` : null,\n        row?.constraints\n          ? `Constraints: ${JSON.stringify(row.constraints)}`\n          : null,\n        row?.raw_message ? `Raw Message: ${row.raw_message}` : null,\n        row?.extraction_confidence != null\n          ? `Extraction Confidence: ${row.extraction_confidence}`\n          : null,\n        row?.missing_fields?.length\n          ? `Missing Fields: ${row.missing_fields.join(\", \")}`\n          : null,\n        row?.contact ? `Contact: ${JSON.stringify(row.contact)}` : null,\n      ]);\n      return {\n        source_type: sourceType,\n        source_id: row.id,\n        lang: row?.language || \"en\",\n        title,\n        content,\n      };\n    }\n    default: {\n      const content = joinLines([row?.content || \"\"]);\n      return {\n        source_type: sourceType,\n        source_id: row.id,\n        lang: row?.lang || \"en\",\n        title: row?.title || null,\n        content,\n      };\n    }\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/rag/chunker.ts"],"sourcesContent":["type Chunk = {\n  index: number;\n  content: string;\n};\n\nconst splitSentences = (text: string) => {\n  return text\n    .replace(/\\s+/g, \" \")\n    .trim()\n    .split(/(?<=[.!?])\\s+/);\n};\n\nexport const chunkText = (text: string, maxLength = 800): Chunk[] => {\n  const normalized = text.replace(/\\s+/g, \" \").trim();\n  if (!normalized) return [];\n\n  const sentences = splitSentences(normalized);\n  const chunks: Chunk[] = [];\n  let current = \"\";\n  let index = 0;\n\n  const pushChunk = (value: string) => {\n    const trimmed = value.trim();\n    if (!trimmed) return;\n    chunks.push({ index, content: trimmed });\n    index += 1;\n  };\n\n  for (const sentence of sentences) {\n    if (!sentence) continue;\n    if (sentence.length > maxLength) {\n      if (current) {\n        pushChunk(current);\n        current = \"\";\n      }\n      for (let i = 0; i < sentence.length; i += maxLength) {\n        pushChunk(sentence.slice(i, i + maxLength));\n      }\n      continue;\n    }\n\n    if ((current + \" \" + sentence).trim().length > maxLength) {\n      pushChunk(current);\n      current = sentence;\n    } else {\n      current = current ? `${current} ${sentence}` : sentence;\n    }\n  }\n\n  if (current) pushChunk(current);\n  return chunks;\n};\n"],"names":[],"mappings":";;;;AAKA,MAAM,iBAAiB,CAAC;IACtB,OAAO,KACJ,OAAO,CAAC,QAAQ,KAChB,IAAI,GACJ,KAAK,CAAC;AACX;AAEO,MAAM,YAAY,CAAC,MAAc,YAAY,GAAG;IACrD,MAAM,aAAa,KAAK,OAAO,CAAC,QAAQ,KAAK,IAAI;IACjD,IAAI,CAAC,YAAY,OAAO,EAAE;IAE1B,MAAM,YAAY,eAAe;IACjC,MAAM,SAAkB,EAAE;IAC1B,IAAI,UAAU;IACd,IAAI,QAAQ;IAEZ,MAAM,YAAY,CAAC;QACjB,MAAM,UAAU,MAAM,IAAI;QAC1B,IAAI,CAAC,SAAS;QACd,OAAO,IAAI,CAAC;YAAE;YAAO,SAAS;QAAQ;QACtC,SAAS;IACX;IAEA,KAAK,MAAM,YAAY,UAAW;QAChC,IAAI,CAAC,UAAU;QACf,IAAI,SAAS,MAAM,GAAG,WAAW;YAC/B,IAAI,SAAS;gBACX,UAAU;gBACV,UAAU;YACZ;YACA,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,MAAM,EAAE,KAAK,UAAW;gBACnD,UAAU,SAAS,KAAK,CAAC,GAAG,IAAI;YAClC;YACA;QACF;QAEA,IAAI,CAAC,UAAU,MAAM,QAAQ,EAAE,IAAI,GAAG,MAAM,GAAG,WAAW;YACxD,UAAU;YACV,UAAU;QACZ,OAAO;YACL,UAAU,UAAU,GAAG,QAAQ,CAAC,EAAE,UAAU,GAAG;QACjD;IACF;IAEA,IAAI,SAAS,UAAU;IACvB,OAAO;AACT"}},
    {"offset": {"line": 238, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/src/lib/rag/ingest.ts"],"sourcesContent":["import { supabaseAdmin } from \"./supabaseAdmin\";\nimport { buildDocument } from \"./buildDocument\";\nimport { chunkText } from \"./chunker\";\n\ntype SourceType =\n  | \"treatment\"\n  | \"hospital\"\n  | \"review\"\n  | \"normalized_inquiry\"\n  | \"policy\"\n  | \"faq\";\n\nconst nowIso = () => new Date().toISOString();\n\nconst fetchSourceRows = async (sourceType: SourceType, sourceId?: string) => {\n  switch (sourceType) {\n    case \"treatment\": {\n      let q = supabaseAdmin\n        .from(\"treatments\")\n        .select(\n          \"id, slug, name, description, full_description, tags, benefits, price_min, price_max, hospitals(name, location_en, location_kr)\"\n        );\n      if (sourceId) q = q.eq(\"id\", sourceId);\n      return q;\n    }\n    case \"hospital\": {\n      let q = supabaseAdmin\n        .from(\"hospitals\")\n        .select(\n          \"id, slug, name, description, location_en, location_kr, address_detail, tags, operating_hours, doctor_profile\"\n        );\n      if (sourceId) q = q.eq(\"id\", sourceId);\n      return q;\n    }\n    case \"review\": {\n      let q = supabaseAdmin\n        .from(\"reviews\")\n        .select(\"id, treatment_id, user_name, country, rating, content, created_at\");\n      if (sourceId) q = q.eq(\"id\", sourceId);\n      return q;\n    }\n    case \"normalized_inquiry\": {\n      let q = supabaseAdmin\n        .from(\"normalized_inquiries\")\n        .select(\n          \"id, language, country, treatment_id, treatment_slug, objective, constraints, raw_message, extraction_confidence, missing_fields, contact\"\n        );\n      if (sourceId) q = q.eq(\"id\", sourceId);\n      return q;\n    }\n    default:\n      return { data: [], error: null };\n  }\n};\n\nconst upsertDocumentAndChunks = async (doc: {\n  source_type: SourceType;\n  source_id: string;\n  lang: string;\n  title: string | null;\n  content: string;\n}) => {\n  const { data: existing, error: existingError } = await supabaseAdmin\n    .from(\"rag_documents\")\n    .select(\"id, content, version\")\n    .eq(\"source_type\", doc.source_type)\n    .eq(\"source_id\", doc.source_id)\n    .eq(\"lang\", doc.lang)\n    .maybeSingle();\n\n  if (existingError) throw existingError;\n\n  const needsUpdate = !existing || existing.content !== doc.content;\n  let documentId = existing?.id;\n  let version = existing?.version ?? 1;\n\n  if (!existing) {\n    const { data: inserted, error } = await supabaseAdmin\n      .from(\"rag_documents\")\n      .insert({\n        source_type: doc.source_type,\n        source_id: doc.source_id,\n        lang: doc.lang,\n        title: doc.title,\n        content: doc.content,\n        version: 1,\n        created_at: nowIso(),\n        updated_at: nowIso(),\n      })\n      .select(\"id, version\")\n      .single();\n\n    if (error) throw error;\n    documentId = inserted.id;\n    version = inserted.version;\n  } else if (needsUpdate) {\n    const { data: updated, error } = await supabaseAdmin\n      .from(\"rag_documents\")\n      .update({\n        title: doc.title,\n        content: doc.content,\n        version: version + 1,\n        updated_at: nowIso(),\n      })\n      .eq(\"id\", existing.id)\n      .select(\"id, version\")\n      .single();\n\n    if (error) throw error;\n    documentId = updated.id;\n    version = updated.version;\n  }\n\n  if (!documentId) return { updated: false, documentId: null };\n\n  if (needsUpdate) {\n    await supabaseAdmin.from(\"rag_chunks\").delete().eq(\"document_id\", documentId);\n\n    const chunks = chunkText(doc.content);\n    if (chunks.length > 0) {\n      const payload = chunks.map((chunk) => ({\n        document_id: documentId,\n        chunk_index: chunk.index,\n        content: chunk.content,\n        metadata: {\n          source_type: doc.source_type,\n          source_id: doc.source_id,\n          lang: doc.lang,\n          title: doc.title,\n          version,\n        },\n      }));\n      const { error } = await supabaseAdmin.from(\"rag_chunks\").insert(payload);\n      if (error) throw error;\n    }\n  }\n\n  return { updated: needsUpdate, documentId };\n};\n\nexport const ingestSources = async (\n  sourceTypes: SourceType[] = [\n    \"treatment\",\n    \"hospital\",\n    \"review\",\n    \"normalized_inquiry\",\n  ],\n  sourceId?: string\n) => {\n  const results: Record<string, number> = {};\n\n  for (const sourceType of sourceTypes) {\n    const { data, error } = await fetchSourceRows(sourceType, sourceId);\n    if (error) throw error;\n\n    let updatedCount = 0;\n    for (const row of data || []) {\n      const doc = buildDocument(sourceType, row);\n      if (!doc.content) continue;\n      const result = await upsertDocumentAndChunks(doc);\n      if (result.updated) updatedCount += 1;\n    }\n    results[sourceType] = updatedCount;\n  }\n\n  return results;\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 367, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/HEALO_Demo/app/api/rag/ingest/route.ts"],"sourcesContent":["import { ingestSources } from \"../../../../src/lib/rag/ingest\";\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json().catch(() => ({}));\n    const sourceTypes = Array.isArray(body?.sourceTypes)\n      ? body.sourceTypes\n      : undefined;\n    const sourceId = body?.source_id ? String(body.source_id) : undefined;\n    const results = await ingestSources(sourceTypes, sourceId);\n    return Response.json({ ok: true, results });\n  } catch (error: any) {\n    return Response.json(\n      { ok: false, error: error?.message || \"ingest_failed\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACjD,MAAM,cAAc,MAAM,OAAO,CAAC,MAAM,eACpC,KAAK,WAAW,GAChB;QACJ,MAAM,WAAW,MAAM,YAAY,OAAO,KAAK,SAAS,IAAI;QAC5D,MAAM,UAAU,MAAM,IAAA,8IAAa,EAAC,aAAa;QACjD,OAAO,SAAS,IAAI,CAAC;YAAE,IAAI;YAAM;QAAQ;IAC3C,EAAE,OAAO,OAAY;QACnB,OAAO,SAAS,IAAI,CAClB;YAAE,IAAI;YAAO,OAAO,OAAO,WAAW;QAAgB,GACtD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}